#!/usr/bin/env php
<?php

$files = array(
	__DIR__ . '/../../vendor/autoload.php',
	__DIR__ . '/../../../../autoload.php'
);

foreach( $files as $file ) {
	if( file_exists($file) ) {
		require($file);
		break;
	}
}

$flags = new \donatj\Flags();

$tolerance =& $flags->uint('tolerance', 5, 'Computed Difference Tolerance - default 5');
$help      =& $flags->bool('help', false, 'Displays this message');

try {
	$flags->parse();
	if( $help ) {
		throw new Exception;
	}
} catch(Exception $e) {
	die($e->getMessage() . PHP_EOL . $flags->getDefaults() . PHP_EOL);
}

if( $flags->args() ) {
	$subject = "";
	foreach( $flags->args() as $arg ) {
		if( !is_readable($arg) ) {
			echo "Cannot read file: {$arg}\n";
			die(1);
		}
		$subject .= file_get_contents($arg);
	}
} else {
	$subject = file_get_contents("php://stdin");
}

$af = new \donatj\AlikeColorFinder\AlikeColorFinder();
$af->ExtractColorInfo($subject, $tolerance);
